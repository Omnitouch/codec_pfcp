from parse_ie_data import Get_IEs
import socket
PFCP_Attribute_IEs = Get_IEs()

ie_dict = {}

def Vomit_UDP(MESSAGE):
    UDP_IP = "127.0.0.1"
    UDP_PORT = 8805


    print("UDP target IP: %s" % UDP_IP)
    print("UDP target port: %s" % UDP_PORT)
    print("message: %s" % MESSAGE)

    sock = socket.socket(socket.AF_INET, # Internet
                        socket.SOCK_DGRAM) # UDP
    sock.sendto(bytes.fromhex(MESSAGE), (UDP_IP, UDP_PORT))

def PFCP_Factory(flags, msg_type, seid, seqno, spare, ie_list):
    hex_data = ''
    hex_data += str(format(int(seid), 'x').zfill(16))
    hex_data += str(format(int(seqno), 'x').zfill(6))
    hex_data += spare
    for ie in ie_list:
        hex_data += ie

    #Calculate Length
    length = len(hex_data)/2   
    length = str(format(int(length), 'x').zfill(4))

    #Translate Message Type
    msg_type = str(format(int(msg_type), 'x').zfill(2))

    #Put it all together
    hex_data = flags + msg_type + length + hex_data

    Vomit_UDP(hex_data)

Vomit_UDP('213204e9000000000000000000c4ff00003c000500644090fb0039000d02000000000164afdd644090fa0039000d02000000000164afdd644090fb0001006a003800020005001d0004ffffffff00020019001400010000150009010164afdd64409104805f000307db01006c0004000000050051000400006106005100040000c146006d000400000004804b000307db018012000607db01674b298019000307db008ca9000307db0100010068003800020004001d0004ffffffff0002001700140001010016000504656e6574005d000506644522ca006c0004000000040051000400006106005100040000c146006d000400000004804b000307db018012000607db01674b298019000307db008ca9000307db0100010078003800028800001d0004000000010002002e001400010000170025010000217065726d697420696e2069702066726f6d2061737369676e656420746f20616e7900510004000061270051000400006147006d000400008000804b000307db018ca2000e07db706372665f64796e616d69638ca9000307db0200010079003800028000001d0004000000010002002f001400010100170026010000227065726d6974206f75742069702066726f6d20616e7920746f2061737369676e656400510004000061270051000400006147006d000400008000804b000307db018ca2000e07db706372665f64796e616d69638ca9000307db0200030024006c000400000004002c00010400040005002a00010000580001018014000507db0100000003001f006c000400000005002c00010200040005002a0001018014000507db010000000600320051000400006106003e000103002500020800004700040001518084d0000507db020105804b000307db0184d5000307db000006007c0051000400004127003e000102002500020a01001f000901000000000010000000490009010000000000a000000047000400000078002400040000000a84d0000507db030101804b000307db0184d1000607db0000000284d2000607db00004e2084d3000607dbffffffff84d5000307db0084f0000607db000007d100060063005100040000c146003e000103002500020600001f0009010000000000a000000020000400000e1000470004ffffffff005200040000614784d0000507db020103804b000307db0184d4000607db000000008509000307db2884dd000607db0000000000060032005100040000612700250002000084d0000507db030101804b000307db0184d1000607db0000000084d2000607db00004e2000060032005100040000614700250002000084d0000507db030103804b000307db0184d1000607db0000000084d2000607db00004e2000060025005100040000415d00250002000084d0000507db010306804b000307db018ca0000307db0400070030006d0004000000040019000100001a000a000040164000000f6950800d000307db048011000307db098016000307db000007000d006d000400008000001900010000550005005800010100710001018027000307db018001000a07db3708101278ee6ef58002000707db956253b1078004000307db068006000407db021a8009000f07db1837f8001b5937f80000000001800a000507db37f800800b000407db08008017000307db02801b000307db009c41000c07db0000000175675f62776d9c42000b07db0000000104644090f89c43000b07db0000000104644090f7')
ie_list = ['003c000500644090fb']
PFCP_Factory(flags='21', msg_type=51, seid=0, seqno=12345, spare='00', ie_list=ie_list)